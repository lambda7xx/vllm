agentB bs:64 and max_token:256 and model:/home/xiaoxiang/data/Llama-3.1-8B
0 vllm/config.py scheduler_config.py __init__ max_num_batched_tokens: None
3 vllm/config.py scheduler_config.py __init__ max_num_batched_tokens: 1024
INFO 11-04 04:18:03 config.py:1061] Chunked prefill is enabled with max_num_batched_tokens=1024.
INFO 11-04 04:18:03 llm_engine.py:238] Initializing an LLM engine (v0.6.3.post2.dev36+g855e0e6f) with config: model='/home/xiaoxiang/data/Llama-3.1-8B', speculative_config=None, tokenizer='/home/xiaoxiang/data/Llama-3.1-8B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, rope_scaling=None, rope_theta=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=131072, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=/home/xiaoxiang/data/Llama-3.1-8B, num_scheduler_steps=1, chunked_prefill_enabled=True multi_step_stream_outputs=True, enable_prefix_caching=True, use_async_output_proc=True, use_cached_outputs=False, mm_processor_kwargs=None)
INFO 11-04 04:18:04 model_runner.py:1055] Starting to load model /home/xiaoxiang/data/Llama-3.1-8B...
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.50s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.56s/it]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:04<00:01,  1.63s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.20s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.34s/it]

INFO 11-04 04:18:10 model_runner.py:1066] Loading model weights took 14.9888 GB
INFO 11-04 04:18:11 worker.py:260] Memory profiling results: total_gpu_memory=79.15GiB initial_memory_usage=15.50GiB peak_torch_memory=16.17GiB memory_usage_post_profile=15.53Gib non_torch_memory=0.54GiB kv_cache_size=54.53GiB gpu_memory_utilization=0.90
INFO 11-04 04:18:11 gpu_executor.py:122] # GPU blocks: 27919, # CPU blocks: 2048
INFO 11-04 04:18:11 gpu_executor.py:126] Maximum concurrency for 131072 tokens per request: 3.41x
INFO 11-04 04:18:14 model_runner.py:1394] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 11-04 04:18:14 model_runner.py:1398] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 11-04 04:18:28 model_runner.py:1522] Graph capturing finished in 14 secs.
start warm up
finish warm up
recv data from A:{'agentb': True}
agentB start
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:63
1 agentB rid:63 is added to engine
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:61
1 agentB recv data from A the rid:62
1 agentB rid:62 is added to engine
1 agentB rid:61 is added to engine
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:59
1 agentB rid:59 is added to engine
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:57
1 agentB recv data from A the rid:58
1 agentB rid:58 is added to engine
1 agentB rid:57 is added to engine
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:55
1 agentB rid:55 is added to engine
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:54
1 agentB rid:54 is added to engine
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:52
1 agentB recv data from A the rid:53
1 agentB rid:53 is added to engine
1 agentB rid:52 is added to engine
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:51
1 agentB rid:51 is added to engine
2 agentB rid:63 is finished
2agentB will send data to A rid:63
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:48
1 agentB rid:48 is added to engine
2 agentB rid:62 is finished
2agentB will send data to A rid:62
3 agentB send data to A
2 agentB rid:61 is finished
2agentB will send data to A rid:61
3 agentB send data to A
2 agentB rid:59 is finished
2agentB will send data to A rid:59
3 agentB send data to A
2 agentB rid:58 is finished
2agentB will send data to A rid:58
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:50
1 agentB rid:50 is added to engine
2 agentB rid:57 is finished
2agentB will send data to A rid:57
3 agentB send data to A
2 agentB rid:50 is finished
2agentB will send data to A rid:50
2 agentB rid:55 is finished
2agentB will send data to A rid:55
3 agentB send data to A
2 agentB rid:54 is finished
2agentB will send data to A rid:54
3 agentB send data to A
2 agentB rid:53 is finished
2agentB will send data to A rid:53
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:41
1 agentB recv data from A the rid:42
1 agentB rid:42 is added to engine
1 agentB rid:41 is added to engine
2 agentB rid:52 is finished
2agentB will send data to A rid:52
3 agentB send data to A
2 agentB rid:42 is finished
2agentB will send data to A rid:42
2 agentB rid:51 is finished
2agentB will send data to A rid:51
3 agentB send data to A
2 agentB rid:41 is finished
2agentB will send data to A rid:41
3 agentB send data to A
2 agentB rid:48 is finished
2agentB will send data to A rid:48
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:38
1 agentB recv data from A the rid:39
1 agentB rid:39 is added to engine
1 agentB rid:38 is added to engine
2 agentB rid:39 is finished
2agentB will send data to A rid:39
3 agentB send data to A
2 agentB rid:38 is finished
2agentB will send data to A rid:38
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:37
1 agentB rid:37 is added to engine
2 agentB rid:37 is finished
2agentB will send data to A rid:37
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:36
1 agentB rid:36 is added to engine
2 agentB rid:36 is finished
2agentB will send data to A rid:36
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:33
1 agentB rid:33 is added to engine
2 agentB rid:33 is finished
2agentB will send data to A rid:33
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:31
1 agentB recv data from A the rid:60
1 agentB rid:60 is added to engine
1 agentB rid:31 is added to engine
2 agentB rid:60 is finished
2agentB will send data to A rid:60
3 agentB send data to A
2 agentB rid:31 is finished
2agentB will send data to A rid:31
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:29
1 agentB recv data from A the rid:47
1 agentB rid:47 is added to engine
1 agentB rid:29 is added to engine
2 agentB rid:47 is finished
2agentB will send data to A rid:47
3 agentB send data to A
2 agentB rid:29 is finished
2agentB will send data to A rid:29
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:27
1 agentB recv data from A the rid:28
1 agentB rid:28 is added to engine
1 agentB rid:27 is added to engine
2 agentB rid:28 is finished
2agentB will send data to A rid:28
3 agentB send data to A
2 agentB rid:27 is finished
2agentB will send data to A rid:27
3 agentB send data to A
0 agentB recv data from A, data:3
1 agentB recv data from A the rid:25
1 agentB recv data from A the rid:26
1 agentB recv data from A the rid:30
1 agentB rid:30 is added to engine
1 agentB rid:26 is added to engine
1 agentB rid:25 is added to engine
2 agentB rid:30 is finished
2agentB will send data to A rid:30
3 agentB send data to A
2 agentB rid:25 is finished
2agentB will send data to A rid:25
2 agentB rid:26 is finished
2agentB will send data to A rid:26
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:24
1 agentB rid:24 is added to engine
2 agentB rid:24 is finished
2agentB will send data to A rid:24
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:22
1 agentB recv data from A the rid:23
1 agentB rid:23 is added to engine
1 agentB rid:22 is added to engine
2 agentB rid:23 is finished
2agentB will send data to A rid:23
3 agentB send data to A
2 agentB rid:22 is finished
2agentB will send data to A rid:22
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:20
1 agentB recv data from A the rid:21
1 agentB rid:21 is added to engine
1 agentB rid:20 is added to engine
2 agentB rid:21 is finished
2agentB will send data to A rid:21
3 agentB send data to A
2 agentB rid:20 is finished
2agentB will send data to A rid:20
3 agentB send data to A
0 agentB recv data from A, data:3
1 agentB recv data from A the rid:18
1 agentB recv data from A the rid:19
1 agentB recv data from A the rid:32
1 agentB rid:32 is added to engine
1 agentB rid:19 is added to engine
1 agentB rid:18 is added to engine
2 agentB rid:32 is finished
2agentB will send data to A rid:32
3 agentB send data to A
2 agentB rid:18 is finished
2agentB will send data to A rid:18
2 agentB rid:19 is finished
2agentB will send data to A rid:19
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:16
1 agentB recv data from A the rid:17
1 agentB rid:17 is added to engine
1 agentB rid:16 is added to engine
2 agentB rid:17 is finished
2agentB will send data to A rid:17
3 agentB send data to A
2 agentB rid:16 is finished
2agentB will send data to A rid:16
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:15
1 agentB rid:15 is added to engine
2 agentB rid:15 is finished
2agentB will send data to A rid:15
3 agentB send data to A
0 agentB recv data from A, data:4
1 agentB recv data from A the rid:13
1 agentB recv data from A the rid:14
1 agentB recv data from A the rid:46
1 agentB recv data from A the rid:34
1 agentB rid:34 is added to engine
1 agentB rid:46 is added to engine
1 agentB rid:14 is added to engine
1 agentB rid:13 is added to engine
2 agentB rid:34 is finished
2agentB will send data to A rid:34
3 agentB send data to A
2 agentB rid:14 is finished
2agentB will send data to A rid:14
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:12
1 agentB rid:12 is added to engine
2 agentB rid:13 is finished
2agentB will send data to A rid:13
3 agentB send data to A
2 agentB rid:12 is finished
2agentB will send data to A rid:12
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:9
1 agentB recv data from A the rid:10
1 agentB rid:10 is added to engine
1 agentB rid:9 is added to engine
2 agentB rid:10 is finished
2agentB will send data to A rid:10
3 agentB send data to A
2 agentB rid:9 is finished
2agentB will send data to A rid:9
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:8
1 agentB rid:8 is added to engine
2 agentB rid:8 is finished
2agentB will send data to A rid:8
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:6
1 agentB rid:6 is added to engine
2 agentB rid:6 is finished
2agentB will send data to A rid:6
3 agentB send data to A
0 agentB recv data from A, data:2
1 agentB recv data from A the rid:4
1 agentB recv data from A the rid:5
1 agentB rid:5 is added to engine
1 agentB rid:4 is added to engine
2 agentB rid:5 is finished
2agentB will send data to A rid:5
3 agentB send data to A
2 agentB rid:4 is finished
2agentB will send data to A rid:4
2 agentB rid:46 is finished
2agentB will send data to A rid:46
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:3
1 agentB rid:3 is added to engine
2 agentB rid:3 is finished
2agentB will send data to A rid:3
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:1
1 agentB rid:1 is added to engine
2 agentB rid:1 is finished
2agentB will send data to A rid:1
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:35
1 agentB rid:35 is added to engine
2 agentB rid:35 is finished
2agentB will send data to A rid:35
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:11
1 agentB rid:11 is added to engine
2 agentB rid:11 is finished
2agentB will send data to A rid:11
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:0
1 agentB rid:0 is added to engine
INFO 11-04 04:18:35 metrics.py:363] Avg prompt throughput: 6587.6 tokens/s, Avg generation throughput: 74.6 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%.
INFO 11-04 04:18:35 metrics.py:379] Prefix cache hit rate: GPU: 97.73%, CPU: 0.00%
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:44
1 agentB rid:44 is added to engine
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:45
1 agentB rid:45 is added to engine
2 agentB rid:0 is finished
2agentB will send data to A rid:0
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:56
1 agentB rid:56 is added to engine
2 agentB rid:44 is finished
2agentB will send data to A rid:44
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:43
1 agentB rid:43 is added to engine
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:40
1 agentB rid:40 is added to engine
2 agentB rid:40 is finished
2agentB will send data to A rid:40
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:49
1 agentB rid:49 is added to engine
2 agentB rid:43 is finished
2agentB will send data to A rid:43
3 agentB send data to A
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:7
1 agentB rid:7 is added to engine
0 agentB recv data from A, data:1
1 agentB recv data from A the rid:2
1 agentB rid:2 is added to engine
2 agentB rid:45 is finished
2agentB will send data to A rid:45
3 agentB send data to A
2 agentB rid:56 is finished
2agentB will send data to A rid:56
3 agentB send data to A
INFO 11-04 04:18:40 metrics.py:363] Avg prompt throughput: 1640.1 tokens/s, Avg generation throughput: 218.4 tokens/s, Running: 3 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.5%, CPU KV cache usage: 0.0%.
INFO 11-04 04:18:40 metrics.py:379] Prefix cache hit rate: GPU: 95.15%, CPU: 0.00%
2 agentB rid:49 is finished
2agentB will send data to A rid:49
3 agentB send data to A
2 agentB rid:7 is finished
2agentB will send data to A rid:7
3 agentB send data to A
2 agentB rid:2 is finished
2agentB will send data to A rid:2
3 agentB send data to A
